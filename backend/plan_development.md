# Детальный план доработки проекта (актуально на 2025-07-10)

## 1. Сегментация и 3D-реконструкция
- Интеграция продвинутых моделей сегментации (3D Slicer CLI, nnUNet, MONAI)
- Выбор органа/структуры для сегментации через API
- Сохранение параметров и версии модели для аудита
- Ручная коррекция маски (web-интерфейс или Unity)
- История изменений маски, экспорт итоговой маски
- Экспорт маски в DICOM-SEG
- Сглаживание mesh после marching cubes
- Визуализация и контроль качества mesh (автоматические скриншоты, отчёты)

## 2. Работа с 3D-моделями
- Приведение STL/GLTF к системе координат пациента (DICOM ↔ Unity)
- Экспорт трансформаций (JSON/CSV)
- Расчёт смещений и деформаций между положениями (спина/бок)
- Алгоритмы трансформации mesh по анатомическим точкам
- Расчёт расстояний, углов, анализ конфликтов (например, близость к костям)

## 3. REST API и интеграция
- Endpoint для экспорта PDF-отчёта, PNG-скриншотов, логов (JSON/CSV)
- Endpoint для логирования действий пользователя и сессии
- Расширение интеграции с Unity: загрузка моделей, масок, отчётов, логов

## 4. Экспорт и отчёты
- Генерация PDF-отчётов с метаданными, координатами, скриншотами (reportlab)
- Экспорт PNG-скриншотов (Pillow, Unity RenderTexture)
- Экспорт логов (JSON/CSV): координаты, параметры, временные метки
- Хранение логов по сессиям, экспорт для анализа

## 5. Логирование и аудит
- Логирование всех действий пользователя (загрузка, расчёт, экспорт, коррекция)
- Хранение логов по сессиям, экспорт для аудита

## 6. Frontend (Unity)
- Загрузка и отображение GLTF/STL через API
- AR-сцена с наложением модели на камеру (AR Foundation)
- UI ��ля ручной корректировки модели и точек троакаров
- Визуализация точек, углов, анатомических ориентиров
- Экспорт скриншотов, логирование действий
- Поддержка маркеров (QR/ArUco) для привязки модели
- Интеграция всех сценариев с REST API

## 7. Инфраструктура и интеграции
- Dockerfile для backend (Python) и Unity build
- GitHub Actions для CI/CD (тесты, сборка, деплой)
- Документация по API, архитектуре, пользовательским сценариям
- Доработка интеграции с PACS (Orthanc, DICOMweb): загрузка, выгрузка, DICOM-SEG

## 8. Тестирование и документация
- Модульные и интеграционные тесты (pytest, unittest, Unity Test Framework)
- Тестовые сценарии для всех пользовательских кейсов
- Документация по каждому модулю (docs/, README, примеры запросов)
- Поддержка актуальности планов и инструкций

---

### Приоритеты для ближайшей реализации:
1. Продвинутая сегментация и ручная коррекция
2. Экспорт DICOM-SEG, PDF, PNG, логов
3. Сглаживание mesh, контроль качества
4. Интеграция с Unity (ручная коррекция, AR, маркеры)
5. Docker, CI/CD, документация
