# Детальный план доработки проекта (актуально на 2025-07-10)

## 1. Сегментация и 3D-реконструкция
- Интеграция продвинутых моделей сегментации (3D Slicer CLI, nnUNet, MONAI)
- Выбор органа/структуры для сегментации через API
- Сохранение параметров и версии модели для аудита
- Ручная коррекция маски (web-интерфейс или Unity)
- История изменений маски, экспорт итоговой маски
- Экспорт маски в DICOM-SEG
- Сглаживание mesh после marching cubes
- Визуализация и контроль качества mesh (автоматические скриншоты, отчёты)

## 2. Работа с 3D-моделями
- Приведение STL/GLTF к системе координат пациента (DICOM ↔ Unity)
- Экспорт трансформаций (JSON/CSV)
- Расчёт смещений и деформаций между положениями (спина/бок)
- Алгоритмы трансформации mesh по анатомическим точкам
- Расчёт расстояний, углов, анализ конфликтов (например, близость к костям)

## 3. REST API и интеграция
- Endpoint для экспорта PDF-отчёта, PNG-скриншотов, логов (JSON/CSV)
- Endpoint для логирования действий пользователя и сессии
- Расширение интеграции с Unity: загрузка моделей, масок, отчётов, логов

## 4. AR и визуальные маркеры
- Интеграция поддержки визуальных маркеров (QR/ArUco/AprilTag) для начальной привязки модели в Unity
- Реализация комбинированной привязки: визуальные маркеры + анатомические ориентиры
- Поддержка ручной калибровки положения, масштаба и вращения модели в Unity

## 5. Анатомические ориентиры и координатная система
- Импорт/выделение анатомических точек из DICOM (пупок, рёберная дуга, подвздошная кость и др.)
- Построение анатомической координатной системы для расчёта троакаров
- Экспорт координат и углов относительно анатомических ориентиров

## 6. Анализ смещений и деформаций
- Алгоритмы анализа смещений и деформаций органов при смене положения тела (спина/бок)
- Применение трансформаций к mesh на основе изменений анатомических точек
- Экспорт трансформированных координат и моделей

## 7. Экспорт, логирование и отчёты
- Расширение отчёта: добавление анатомических точек, положения маркера, всех трансформаций
- Экспорт логов с временными метками (CSV/JSON)
- Экспорт отчёта в PDF с вложенными PNG-скриншотами и логами

## 8. Unity-клиент
- Поддержка распознавания маркеров и привязки модели
- Встроенные инструменты ручной корректировки и калибровки
- Логирование пользовательских действий (корректировки, экспорт, сценарии)
- Возможность трансляции AR-сцены на внешний монитор

## 9. Тестовые сценарии
- Реализация сценариев тестирования на предустановленных кейсах
- Импорт и обработка тестовых DICOM-датасетов

## 10. Документация и поддержка
- Обновление документации по новым сценариям, форматам данных и API
- Описание пользовательских сценариев и инструкций

---

### Приоритеты для ближайшей реализации:
1. Продвинутая сегментация и ручная коррекция
2. Экспорт DICOM-SEG, PDF, PNG, логов
3. Сглаживание mesh, контроль качества
4. Интеграция с Unity (ручная коррекция, AR, маркеры)
5. Docker, CI/CD, документация
